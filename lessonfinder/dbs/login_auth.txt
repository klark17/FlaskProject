        if db.session.query(User.id).filter_by(username=form.username.data).scalar():
            user = User.query.filter_by(username=form.username.data).first()
            if user and user.password == form.password.data:
                login_user(user, remember=form.remember.data)
                next_page = request.args.get('next')
                flash('You have been logged in!', 'success')
                return redirect(next_page) if next_page else redirect(url_for('profile'))
            else:
                flash('Login Unsuccessful. Please check username and password', 'danger')
        elif db.session.query(Admin.id).filter_by(username=form.username.data).scalar():
            admin = Admin.query.filter_by(username=form.username.data).first()
            if admin and admin.password == form.password.data:
                login_user(admin, remember=form.remember.data)
                next_page = request.args.get('next')
                org = admin.organization
                flash('You have been logged in as an administrator!', 'success')
                return redirect(next_page) if next_page else redirect(url_for('admin_profile',
                                                                              name=org.name, lessons=admin.lessons))
            else:
                flash('Login Unsuccessful. Please check username and password', 'danger')
    